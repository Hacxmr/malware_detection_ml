# Malware Detection with Machine Learning

This project aims to build a machine learning model to classify legitimate and malicious software using various classification techniques, including Random Forest, Logistic Regression, and Neural Networks.

## Dataset

The dataset contains 103,675 samples with 57 features, including attributes such as file size, version information, and entropy measures.

## Data Cleaning

We start by cleaning the dataset. We drop columns `Name` and `md5` as they are not necessary for the analysis. We also handle missing values.

```python
import pandas as pd
mal_data = pd.read_csv("/content/MalwareData.csv", sep="|", low_memory=False)
mal_data.drop(['Name', 'md5'], axis=1, inplace=True)
mal_data.dropna(inplace=True)

```

## Random Forest Model

```python
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, f1_score

clf = RandomForestClassifier(max_depth=2, random_state=0)
random_model = clf.fit(X_train, Y_train)

# Evaluate model
train_pred = random_model.predict(X_train)
test_pred = random_model.predict(X_test)

print("Train Accuracy:", accuracy_score(Y_train, train_pred))
print("Test Accuracy:", accuracy_score(Y_test, test_pred))
print("F1 Score:", f1_score(Y_test, test_pred))

```

## Logistic Regression Model

```python
from sklearn.linear_model import LogisticRegression

logistic_model = LogisticRegression(max_iter=200)
logistic_model.fit(X_train, Y_train)

# Evaluate model
train_pred = logistic_model.predict(X_train)
test_pred = logistic_model.predict(X_test)

print("Train Accuracy:", accuracy_score(Y_train, train_pred))
print("Test Accuracy:", accuracy_score(Y_test, test_pred))
print("F1 Score:", f1_score(Y_test, test_pred))

```

## Neural Network

```python
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

model = Sequential()
model.add(Dense(16, input_dim=54, activation="relu"))
model.add(Dense(8, activation="relu"))
model.add(Dense(4, activation="relu"))
model.add(Dense(1, activation="sigmoid"))

model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
model.fit(X_train, Y_train, epochs=5, batch_size=32)

# Evaluate model
train_pred = model.predict(X_train)
test_pred = model.predict(X_test)

train_pred = [1 if pred >= 0.5 else 0 for pred in train_pred]
test_pred = [1 if pred >= 0.5 else 0 for pred in test_pred]

print("Train Accuracy:", accuracy_score(Y_train, train_pred))
print("Test Accuracy:", accuracy_score(Y_test, test_pred))

```



## Confusion Matrix
```python
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.metrics import confusion_matrix

cm = confusion_matrix(Y_test, logistic_model.predict(X_test))

plt.figure(figsize=(10, 7))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=[0, 1], yticklabels=[0, 1])
plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.title('Confusion Matrix')
plt.show()

```



## Normalized Confusion Matrix
```python
cm_normalized = confusion_matrix(Y_test, logistic_model.predict(X_test), normalize='true')

plt.figure(figsize=(10, 7))
sns.heatmap(cm_normalized, annot=True, fmt='.2f', cmap='Blues', xticklabels=[0, 1], yticklabels=[0, 1])
plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.title('Normalized Confusion Matrix')
plt.show()

```


